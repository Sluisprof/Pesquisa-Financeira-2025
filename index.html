<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Quiz Financeiro</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #ffbe0b;
            --light: #f8f9fa;
            --dark: #212529;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 25px;
            border-radius: 15px 15px 0 0;
            box-shadow: var(--shadow);
            text-align: center;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .mode-selector {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            gap: 20px;
        }
        
        .mode-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background-color: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .mode-btn.active {
            background-color: var(--primary);
            color: white;
        }
        
        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        /* ESTILOS DO QUIZ DO ALUNO */
        .quiz-container, .admin-panel {
            background-color: white;
            border-radius: 0 0 15px 15px;
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 30px;
            display: none;
        }
        
        .active-mode {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .intro-screen, .question-screen, .results-screen {
            padding: 30px;
            display: none;
        }
        
        .active-screen {
            display: block;
        }
        
        .intro-content {
            text-align: center;
            padding: 20px 0;
        }
        
        .intro-content p {
            margin-bottom: 25px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .student-info {
            max-width: 500px;
            margin: 0 auto 30px;
            text-align: left;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .question-number {
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .question-text {
            font-size: 1.3rem;
            margin-bottom: 25px;
            font-weight: 600;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .option {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        .option:hover {
            border-color: var(--primary);
            background-color: #f0f4ff;
        }
        
        .option.selected {
            border-color: var(--primary);
            background-color: #e6eeff;
        }
        
        .option-letter {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 30px;
            height: 30px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary);
        }
        
        .btn-secondary {
            background-color: #e0e0e0;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background-color: #d0d0d0;
        }
        
        .btn-accent {
            background-color: var(--accent);
            color: white;
        }
        
        .btn-accent:hover {
            background-color: #e11570;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 25px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .results-content {
            text-align: center;
            padding: 20px 0;
        }
        
        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) 0%, #e0e0e0 0%);
            margin: 0 auto 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .score-inner {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .score-text {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--secondary);
        }
        
        .feedback {
            background-color: #f0f4ff;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: left;
        }
        
        .feedback h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .tips {
            margin-top: 30px;
            text-align: left;
        }
        
        .tips h3 {
            color: var(--secondary);
            margin-bottom: 15px;
        }
        
        .tips ul {
            padding-left: 20px;
        }
        
        .tips li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        /* ESTILOS DO PAINEL DO PROFESSOR */
        .tabs {
            display: flex;
            background-color: #f0f4ff;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            background-color: white;
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .tab-content {
            padding: 25px;
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
        }
        
        .stat-card h3 {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--primary);
        }
        
        tr:hover {
            background-color: #f5f7ff;
        }
        
        .score-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .score-high {
            background-color: #e6f7ee;
            color: #0d8b5c;
        }
        
        .score-medium {
            background-color: #fff4e6;
            color: #e67e22;
        }
        
        .score-low {
            background-color: #ffe6e6;
            color: #e74c3c;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            height: 300px;
        }
        
        .student-detail {
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            display: none;
        }
        
        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .student-info h2 {
            color: var(--primary);
        }
        
        .student-info p {
            color: #666;
        }
        
        .answers-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .answer-card {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
        }
        
        .answer-card.correct {
            border-left: 4px solid #4cc9f0;
        }
        
        .answer-card.incorrect {
            border-left: 4px solid #f72585;
        }
        
        .answer-card.essay {
            border-left: 4px solid #ffbe0b;
        }
        
        .question-text {
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .student-answer {
            color: #f72585;
            margin-bottom: 5px;
        }
        
        .correct-answer {
            color: #4cc9f0;
        }
        
        .essay-answer {
            background-color: #fff9e6;
            padding: 10px;
            border-radius: 5px;
            margin-top: 5px;
            font-style: italic;
        }
        
        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .mode-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .mode-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .student-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .navigation {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation button {
                width: 100%;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Sistema de Quiz Financeiro</h1>
            <p class="subtitle">Para estudantes do 1º Ano - Versão Aluno e Professor</p>
        </header>
        
        <div class="mode-selector">
            <button class="mode-btn active" data-mode="student">Modo Aluno</button>
            <button class="mode-btn" data-mode="teacher">Modo Professor</button>
        </div>
        
        <!-- MODO ALUNO -->
        <div class="quiz-container active-mode" id="studentMode">
            <!-- Tela de Introdução -->
            <div class="intro-screen active-screen" id="introScreen">
                <div class="intro-content">
                    <h2>Quiz de Educação Financeira</h2>
                    <p>Este quiz foi desenvolvido para ajudar você a aprender sobre planejamento financeiro e tomar melhores decisões com seu dinheiro.</p>
                    <p>O quiz contém 10 perguntas objetivas e 1 pergunta dissertativa sobre profissões.</p>
                    
                    <div class="student-info">
                        <div class="form-group">
                            <label for="studentName">Seu Nome</label>
                            <input type="text" id="studentName" placeholder="Digite seu nome completo">
                        </div>
                        <div class="form-group">
                            <label for="studentClass">Sua Turma</label>
                            <select id="studentClass">
                                <option value="">Selecione sua turma</option>
                                <option value="1A">1º Ano A</option>
                                <option value="1B">1º Ano B</option>
                            </select>
                        </div>
                    </div>
                    
                    <button class="btn-primary start-btn" onclick="startQuiz()">Começar Quiz</button>
                </div>
            </div>
            
            <!-- Tela de Perguntas -->
            <div class="question-screen" id="questionScreen">
                <div class="progress-bar">
                    <div class="progress" id="progressBar"></div>
                </div>
                
                <div class="question-number" id="questionNumber">Pergunta 1 de 11</div>
                <div class="question-text" id="questionText">Qual é a melhor definição de orçamento?</div>
                
                <div class="options-container" id="optionsContainer">
                    <!-- As opções serão inseridas aqui via JavaScript -->
                </div>
                
                <!-- Área para pergunta dissertativa -->
                <div id="essayContainer" style="display: none;">
                    <div class="form-group">
                        <label for="essayAnswer">Sua resposta:</label>
                        <textarea id="essayAnswer" placeholder="Escreva aqui sobre a profissão que você gostaria de seguir e como o planejamento financeiro pode ajudar nessa escolha..."></textarea>
                    </div>
                </div>
                
                <div class="navigation">
                    <button class="btn-secondary prev-btn" onclick="previousQuestion()" id="prevBtn" disabled>Anterior</button>
                    <button class="btn-primary next-btn" onclick="nextQuestion()" id="nextBtn">Próxima</button>
                </div>
            </div>
            
            <!-- Tela de Resultados -->
            <div class="results-screen" id="resultsScreen">
                <div class="results-content">
                    <h2>Quiz Concluído!</h2>
                    <p>Confira seu desempenho:</p>
                    
                    <div class="score-circle" id="scoreCircle">
                        <div class="score-inner">
                            <span id="scoreValue">0</span>%
                        </div>
                    </div>
                    
                    <div class="score-text" id="scoreText">Iniciante em Finanças</div>
                    
                    <div class="feedback" id="feedback">
                        <h3>Seu desempenho</h3>
                        <p id="feedbackText">Com base nas suas respostas, você está começando a entender conceitos financeiros. Continue aprendendo!</p>
                    </div>
                    
                    <div class="tips">
                        <h3>Dicas para melhorar suas finanças:</h3>
                        <ul id="tipsList">
                            <!-- As dicas serão inseridas aqui via JavaScript -->
                        </ul>
                    </div>
                    
                    <button class="btn-accent restart-btn" onclick="restartQuiz()">Fazer Quiz Novamente</button>
                </div>
            </div>
        </div>
        
        <!-- MODO PROFESSOR -->
        <div class="admin-panel" id="teacherMode">
            <div class="tabs">
                <div class="tab active" data-tab="overview">Visão Geral</div>
                <div class="tab" data-tab="students">Resultados dos Alunos</div>
                <div class="tab" data-tab="questions">Análise por Pergunta</div>
                <div class="tab" data-tab="essays">Respostas Dissertativas</div>
            </div>
            
            <!-- ABA: VISÃO GERAL -->
            <div class="tab-content active" id="overview">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total de Alunos</h3>
                        <div class="stat-value" id="totalStudents">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Pontuação Média</h3>
                        <div class="stat-value" id="averageScore">0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>Melhor Pontuação</h3>
                        <div class="stat-value" id="bestScore">0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>Pior Pontuação</h3>
                        <div class="stat-value" id="worstScore">0%</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="scoreDistributionChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            
            <!-- ABA: RESULTADOS DOS ALUNOS -->
            <div class="tab-content" id="students">
                <div class="filters">
                    <div class="filter-group">
                        <label for="classFilter">Turma</label>
                        <select id="classFilter">
                            <option value="all">Todas as Turmas</option>
                            <option value="1A">1º Ano A</option>
                            <option value="1B">1º Ano B</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="scoreFilter">Pontuação</label>
                        <select id="scoreFilter">
                            <option value="all">Todas as Pontuações</option>
                            <option value="high">Alta (80-100%)</option>
                            <option value="medium">Média (60-79%)</option>
                            <option value="low">Baixa (0-59%)</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="searchStudent">Buscar Aluno</label>
                        <input type="text" id="searchStudent" placeholder="Nome do aluno">
                    </div>
                    <div class="filter-group" style="justify-content: flex-end;">
                        <button class="btn btn-primary" onclick="applyFilters()">Aplicar Filtros</button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="studentsTable">
                        <thead>
                            <tr>
                                <th>Aluno</th>
                                <th>Turma</th>
                                <th>Data</th>
                                <th>Pontuação</th>
                                <th>Tempo</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Os dados serão preenchidos via JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="export-options">
                    <button class="btn btn-secondary" onclick="exportToCSV()">Exportar para CSV</button>
                    <button class="btn btn-primary" onclick="printReport()">Imprimir Relatório</button>
                </div>
            </div>
            
            <!-- ABA: ANÁLISE POR PERGUNTA -->
            <div class="tab-content" id="questions">
                <div class="chart-container">
                    <canvas id="questionAnalysisChart"></canvas>
                </div>
                
                <div class="table-container">
                    <table id="questionsTable">
                        <thead>
                            <tr>
                                <th>Pergunta</th>
                                <th>Taxa de Acerto</th>
                                <th>Alternativa Mais Escolhida</th>
                                <th>Dificuldade</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Os dados serão preenchidos via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ABA: RESPOSTAS DISSERTATIVAS -->
            <div class="tab-content" id="essays">
                <div class="filters">
                    <div class="filter-group">
                        <label for="essayClassFilter">Turma</label>
                        <select id="essayClassFilter">
                            <option value="all">Todas as Turmas</option>
                            <option value="1A">1º Ano A</option>
                            <option value="1B">1º Ano B</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="searchEssay">Buscar Aluno</label>
                        <input type="text" id="searchEssay" placeholder="Nome do aluno">
                    </div>
                    <div class="filter-group" style="justify-content: flex-end;">
                        <button class="btn btn-primary" onclick="applyEssayFilters()">Aplicar Filtros</button>
                    </div>
                </div>
                
                <div id="essaysList">
                    <!-- As respostas dissertativas serão inseridas aqui via JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- MODAL DE DETALHES DO ALUNO -->
        <div id="studentDetailModal" class="student-detail">
            <div class="student-header">
                <div class="student-info">
                    <h2 id="detailStudentName">Maria Silva</h2>
                    <p id="detailStudentClass">1º Ano A - Pontuação: <strong>85%</strong></p>
                </div>
                <button class="btn btn-secondary" onclick="closeStudentDetail()">Fechar</button>
            </div>
            
            <div class="answers-grid" id="studentAnswers">
                <!-- As respostas do aluno serão inseridas aqui via JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // ========== CONFIGURAÇÃO DO SISTEMA ==========
        
        // Dados do quiz (10 perguntas objetivas + 1 dissertativa)
        const questions = [
            {
                question: "Qual é a melhor definição de orçamento?",
                options: [
                    "Um plano que mostra como você vai gastar seu dinheiro",
                    "A quantidade de dinheiro que você ganha por mês",
                    "O dinheiro que sobra depois de pagar todas as contas",
                    "Um empréstimo que você pega no banco"
                ],
                correct: 0,
                explanation: "Um orçamento é um plano financeiro que mostra como você vai gastar seu dinheiro durante um período específico, ajudando a controlar seus gastos."
            },
            {
                question: "Por que é importante poupar dinheiro?",
                options: [
                    "Para comprar coisas caras sem se preocupar",
                    "Para ter uma reserva em caso de emergências",
                    "Para impressionar os amigos",
                    "Porque seus pais mandam"
                ],
                correct: 1,
                explanation: "Poupar é importante principalmente para criar uma reserva de emergência, que pode ajudar em situações imprevistas como problemas de saúde ou despesas urgentes."
            },
            {
                question: "O que são gastos essenciais?",
                options: [
                    "Compras de roupas de marca",
                    "Saídas com amigos",
                    "Despesas com alimentação, moradia e saúde",
                    "Assinaturas de streaming"
                ],
                correct: 2,
                explanation: "Gastos essenciais são aqueles necessários para sua sobrevivência e bem-estar básico, como alimentação, moradia, saúde e educação."
            },
            {
                question: "Qual destes é um exemplo de meta financeira de curto prazo?",
                options: [
                    "Comprar uma casa daqui a 10 anos",
                    "Juntar dinheiro para uma viagem nas férias",
                    "Fazer uma poupança para a aposentadoria",
                    "Comprar um carro quando terminar a faculdade"
                ],
                correct: 1,
                explanation: "Metas de curto prazo são aquelas que você pretende realizar em até 1 ano, como juntar para uma viagem, comprar um celular ou fazer um curso."
            },
            {
                question: "O que significa 'juros'?",
                options: [
                    "O preço que você paga por emprestar dinheiro",
                    "O dinheiro que você ganha trabalhando",
                    "Um desconto em uma compra",
                    "O valor que sobra no final do mês"
                ],
                correct: 0,
                explanation: "Juros são o custo do empréstimo de dinheiro. Quando você pega dinheiro emprestado, paga juros. Quando você investe, recebe juros."
            },
            {
                question: "Qual é a vantagem de comparar preços antes de comprar algo?",
                options: [
                    "Gastar mais tempo fazendo compras",
                    "Encontrar o melhor preço e economizar dinheiro",
                    "Conhecer mais lojas no shopping",
                    "Aumentar suas opções de compra"
                ],
                correct: 1,
                explanation: "Comparar preços permite encontrar o melhor custo-benefício, ajudando você a economizar dinheiro que pode ser usado para outras coisas importantes."
            },
            {
                question: "O que é uma despesa variável?",
                options: [
                    "Uma conta que tem o mesmo valor todo mês",
                    "Um gasto que muda de valor a cada mês",
                    "Um imposto que você paga uma vez por ano",
                    "Um investimento de longo prazo"
                ],
                correct: 1,
                explanation: "Despesas variáveis são aquelas que mudam de valor a cada mês, como gastos com alimentação, entretenimento e combustível."
            },
            {
                question: "Por que é importante estabelecer metas financeiras?",
                options: [
                    "Para ter mais motivação para controlar seus gastos",
                    "Para impressionar seus professores",
                    "Porque todo mundo faz isso",
                    "Para poder gastar mais dinheiro"
                ],
                correct: 0,
                explanation: "Metas financeiras dão direção ao seu planejamento, ajudando a manter o foco e a motivação para economizar e gastar com consciência."
            },
            {
                question: "O que é melhor: comprar à vista ou parcelado?",
                options: [
                    "Sempre à vista, para evitar juros",
                    "Sempre parcelado, para não gastar tudo de uma vez",
                    "Depende da situação e das taxas de juros",
                    "Tanto faz, o valor é o mesmo"
                ],
                correct: 2,
                explanation: "A melhor opção depende da situação. À vista geralmente tem desconto, mas parcelar sem juros pode ser vantajoso se você conseguir investir o dinheiro que teria gasto."
            },
            {
                question: "Qual é a regra 50-30-20 no planejamento financeiro?",
                options: [
                    "Guardar 50%, gastar 30% e investir 20%",
                    "Gastar 50% com necessidades, 30% com desejos e guardar 20%",
                    "Trabalhar 50 horas, descansar 30 e estudar 20",
                    "Comprar 50% à vista, 30% parcelado e 20% no crédito"
                ],
                correct: 1,
                explanation: "A regra 50-30-20 sugere usar 50% da renda para necessidades, 30% para desejos e 20% para poupança e investimentos."
            },
            // Pergunta dissertativa (índice 10)
            {
                question: "Qual profissão você gostaria de seguir no futuro e como o planejamento financeiro pode ajudar você a alcançar esse objetivo?",
                type: "essay"
            }
        ];

        // Armazenamento local para os resultados dos alunos
        let quizResults = JSON.parse(localStorage.getItem('quizResults')) || [];
        
        // Variáveis do quiz do aluno
        let currentQuestion = 0;
        let score = 0;
        let userAnswers = new Array(questions.length).fill(-1);
        let essayAnswer = "";
        let startTime, endTime;

        // Elementos DOM
        const studentMode = document.getElementById('studentMode');
        const teacherMode = document.getElementById('teacherMode');
        const introScreen = document.getElementById('introScreen');
        const questionScreen = document.getElementById('questionScreen');
        const resultsScreen = document.getElementById('resultsScreen');
        const questionNumber = document.getElementById('questionNumber');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const essayContainer = document.getElementById('essayContainer');
        const essayAnswerElement = document.getElementById('essayAnswer');
        const progressBar = document.getElementById('progressBar');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const scoreValue = document.getElementById('scoreValue');
        const scoreText = document.getElementById('scoreText');
        const feedbackText = document.getElementById('feedbackText');
        const tipsList = document.getElementById('tipsList');
        const scoreCircle = document.getElementById('scoreCircle');

        // ========== FUNÇÕES DO MODO ALUNO ==========
        
        // Inicialização quando a página carrega
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar seletor de modo
            setupModeSelector();
            
            // Carregar dados do painel do professor
            loadTeacherData();
        });

        // Configurar seletor de modo (Aluno/Professor)
        function setupModeSelector() {
            const modeButtons = document.querySelectorAll('.mode-btn');
            modeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const mode = this.getAttribute('data-mode');
                    
                    // Remover classe active de todos os botões
                    modeButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Adicionar classe active ao botão clicado
                    this.classList.add('active');
                    
                    // Mostrar o modo selecionado
                    if (mode === 'student') {
                        studentMode.classList.add('active-mode');
                        teacherMode.classList.remove('active-mode');
                    } else {
                        studentMode.classList.remove('active-mode');
                        teacherMode.classList.add('active-mode');
                        loadTeacherData();
                    }
                });
            });
        }

        // Iniciar o quiz
        function startQuiz() {
            const studentName = document.getElementById('studentName').value;
            const studentClass = document.getElementById('studentClass').value;
            
            if (!studentName || !studentClass) {
                alert('Por favor, preencha seu nome e selecione sua turma antes de começar.');
                return;
            }
            
            // Registrar hora de início
            startTime = new Date();
            
            introScreen.classList.remove('active-screen');
            questionScreen.classList.add('active-screen');
            showQuestion();
        }

        // Mostrar pergunta atual
        function showQuestion() {
            const question = questions[currentQuestion];
            
            // Atualizar número da pergunta
            questionNumber.textContent = `Pergunta ${currentQuestion + 1} de ${questions.length}`;
            
            // Atualizar texto da pergunta
            questionText.textContent = question.question;
            
            // Atualizar barra de progresso
            progressBar.style.width = `${((currentQuestion + 1) / questions.length) * 100}%`;
            
            // Verificar se é pergunta dissertativa
            if (question.type === "essay") {
                optionsContainer.style.display = 'none';
                essayContainer.style.display = 'block';
                essayAnswerElement.value = essayAnswer;
            } else {
                optionsContainer.style.display = 'flex';
                essayContainer.style.display = 'none';
                
                // Limpar opções anteriores
                optionsContainer.innerHTML = '';
                
                // Adicionar novas opções
                question.options.forEach((option, index) => {
                    const optionElement = document.createElement('div');
                    optionElement.classList.add('option');
                    if (userAnswers[currentQuestion] === index) {
                        optionElement.classList.add('selected');
                    }
                    
                    optionElement.innerHTML = `
                        <span class="option-letter">${String.fromCharCode(65 + index)}</span>
                        <span class="option-text">${option}</span>
                    `;
                    
                    optionElement.addEventListener('click', () => selectOption(index));
                    optionsContainer.appendChild(optionElement);
                });
            }
            
            // Atualizar estado dos botões
            prevBtn.disabled = currentQuestion === 0;
            
            if (currentQuestion === questions.length - 1) {
                nextBtn.textContent = 'Finalizar';
            } else {
                nextBtn.textContent = 'Próxima';
            }
        }

        // Selecionar uma opção
        function selectOption(optionIndex) {
            userAnswers[currentQuestion] = optionIndex;
            
            // Remover seleção de todas as opções
            const options = document.querySelectorAll('.option');
            options.forEach(option => option.classList.remove('selected'));
            
            // Adicionar seleção à opção clicada
            options[optionIndex].classList.add('selected');
        }

        // Próxima pergunta
        function nextQuestion() {
            const question = questions[currentQuestion];
            
            // Validar resposta
            if (question.type === "essay") {
                // Para pergunta dissertativa, apenas salvar a resposta
                essayAnswer = essayAnswerElement.value;
                if (!essayAnswer.trim()) {
                    alert('Por favor, escreva sua resposta antes de continuar.');
                    return;
                }
            } else {
                // Para perguntas objetivas
                if (userAnswers[currentQuestion] === -1) {
                    alert('Por favor, selecione uma resposta antes de continuar.');
                    return;
                }
            }
            
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion();
            } else {
                calculateResults();
                saveResults();
                showResults();
            }
        }

        // Pergunta anterior
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion();
            }
        }

        // Calcular resultados (apenas para perguntas objetivas)
        function calculateResults() {
            score = 0;
            for (let i = 0; i < questions.length - 1; i++) { // -1 para excluir a dissertativa
                if (userAnswers[i] === questions[i].correct) {
                    score++;
                }
            }
            
            // Calcular tempo gasto
            endTime = new Date();
            const timeDiff = endTime - startTime; // em milissegundos
            const minutes = Math.floor(timeDiff / 60000);
            const seconds = ((timeDiff % 60000) / 1000).toFixed(0);
            quizTime = `${minutes}:${seconds.padStart(2, '0')}`;
        }

        // Salvar resultados no localStorage
        function saveResults() {
            const studentName = document.getElementById('studentName').value;
            const studentClass = document.getElementById('studentClass').value;
            
            // Calcular porcentagem apenas das perguntas objetivas
            const percentage = Math.round((score / (questions.length - 1)) * 100);
            
            const result = {
                id: Date.now(), // ID único baseado no timestamp
                name: studentName,
                class: studentClass,
                date: new Date().toISOString().split('T')[0],
                score: percentage,
                time: quizTime,
                essay: essayAnswer,
                answers: userAnswers.slice(0, -1).map((answer, index) => ({
                    question: questions[index].question,
                    correct: answer === questions[index].correct,
                    studentAnswer: answer,
                    correctAnswer: questions[index].correct
                }))
            };
            
            // Adicionar aos resultados e salvar no localStorage
            quizResults.push(result);
            localStorage.setItem('quizResults', JSON.stringify(quizResults));
        }

        // Mostrar resultados
        function showResults() {
            questionScreen.classList.remove('active-screen');
            resultsScreen.classList.add('active-screen');
            
            const percentage = Math.round((score / (questions.length - 1)) * 100);
            
            // Atualizar pontuação
            scoreValue.textContent = percentage;
            
            // Animar o círculo de pontuação
            setTimeout(() => {
                scoreCircle.style.background = `conic-gradient(var(--primary) ${percentage}%, #e0e0e0 ${percentage}%)`;
            }, 100);
            
            // Definir texto de acordo com a pontuação
            if (percentage >= 90) {
                scoreText.textContent = 'Expert Financeiro!';
                feedbackText.textContent = 'Parabéns! Você demonstrou um excelente conhecimento sobre planejamento financeiro. Continue assim!';
            } else if (percentage >= 70) {
                scoreText.textContent = 'Bom Conhecimento Financeiro';
                feedbackText.textContent = 'Muito bom! Você tem uma boa base de conhecimentos financeiros, mas ainda pode aprender mais.';
            } else if (percentage >= 50) {
                scoreText.textContent = 'Conhecimento Básico em Finanças';
                feedbackText.textContent = 'Você tem algumas noções de educação financeira, mas precisa se aprofundar mais no assunto.';
            } else {
                scoreText.textContent = 'Iniciante em Finanças';
                feedbackText.textContent = 'Não se preocupe! Todos começam de algum lugar. Use este quiz como ponto de partida para aprender mais sobre finanças.';
            }
            
            // Adicionar dicas
            tipsList.innerHTML = `
                <li>Anote seus gastos por uma semana para entender para onde seu dinheiro está indo</li>
                <li>Estabeleça uma meta de economia, mesmo que seja pequena</li>
                <li>Pense duas vezes antes de fazer compras por impulso</li>
                <li>Aprenda a diferença entre necessidades e desejos</li>
                <li>Pesquise preços antes de fazer compras importantes</li>
                <li>Comece a pensar em como sua profissão dos sonhos pode se alinhar com seus objetivos financeiros</li>
            `;
        }

        // Reiniciar quiz
        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            userAnswers = new Array(questions.length).fill(-1);
            essayAnswer = "";
            
            resultsScreen.classList.remove('active-screen');
            introScreen.classList.add('active-screen');
            
            // Limpar campos do formulário
            document.getElementById('studentName').value = "";
            document.getElementById('studentClass').value = "";
        }

        // ========== FUNÇÕES DO MODO PROFESSOR ==========
        
        // Configurar abas do painel do professor
        function setupTeacherTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Remover classe active de todas as abas e conteúdos
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Adicionar classe active à aba e conteúdo clicados
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // Carregar dados do painel do professor
        function loadTeacherData() {
            setupTeacherTabs();
            loadOverviewData();
            loadStudentsTable();
            loadQuestionsAnalysis();
            loadEssays();
            initializeCharts();
        }

        // Carregar dados da visão geral
        function loadOverviewData() {
            if (quizResults.length === 0) {
                document.getElementById('totalStudents').textContent = '0';
                document.getElementById('averageScore').textContent = '0%';
                document.getElementById('bestScore').textContent = '0%';
                document.getElementById('worstScore').textContent = '0%';
                return;
            }
            
            document.getElementById('totalStudents').textContent = quizResults.length;
            
            // Calcular pontuação média
            const totalScore = quizResults.reduce((sum, student) => sum + student.score, 0);
            const averageScore = Math.round(totalScore / quizResults.length);
            document.getElementById('averageScore').textContent = `${averageScore}%`;
            
            // Encontrar melhor e pior pontuação
            const scores = quizResults.map(student => student.score);
            const bestScore = Math.max(...scores);
            const worstScore = Math.min(...scores);
            
            document.getElementById('bestScore').textContent = `${bestScore}%`;
            document.getElementById('worstScore').textContent = `${worstScore}%`;
        }

        // Carregar tabela de alunos
        function loadStudentsTable() {
            const tbody = document.querySelector('#studentsTable tbody');
            tbody.innerHTML = '';
            
            if (quizResults.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">Nenhum resultado disponível</td>`;
                tbody.appendChild(row);
                return;
            }
            
            quizResults.forEach(student => {
                const scoreClass = student.score >= 80 ? 'score-high' : 
                                 student.score >= 60 ? 'score-medium' : 'score-low';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>${formatDate(student.date)}</td>
                    <td><span class="score-badge ${scoreClass}">${student.score}%</span></td>
                    <td>${student.time}</td>
                    <td><button class="btn btn-secondary" onclick="viewStudentDetail(${student.id})">Ver Detalhes</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Carregar análise por pergunta
        function loadQuestionsAnalysis() {
            const tbody = document.querySelector('#questionsTable tbody');
            tbody.innerHTML = '';
            
            if (quizResults.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4" style="text-align: center;">Nenhum resultado disponível</td>`;
                tbody.appendChild(row);
                return;
            }
            
            // Calcular taxa de acerto para cada pergunta (excluindo a dissertativa)
            const questionStats = questions.slice(0, -1).map((question, index) => {
                let correctCount = 0;
                let answerDistribution = [0, 0, 0, 0];
                
                quizResults.forEach(student => {
                    const answer = student.answers[index];
                    if (answer && answer.correct) {
                        correctCount++;
                    }
                    
                    if (answer && answer.studentAnswer !== -1) {
                        answerDistribution[answer.studentAnswer]++;
                    }
                });
                
                const correctRate = Math.round((correctCount / quizResults.length) * 100);
                
                // Encontrar alternativa mais escolhida
                let maxIndex = 0;
                for (let i = 1; i < answerDistribution.length; i++) {
                    if (answerDistribution[i] > answerDistribution[maxIndex]) {
                        maxIndex = i;
                    }
                }
                
                const mostCommon = `${String.fromCharCode(65 + maxIndex)} (${Math.round((answerDistribution[maxIndex] / quizResults.length) * 100)}%)`;
                
                // Determinar dificuldade
                let difficulty = "Fácil";
                if (correctRate < 50) difficulty = "Difícil";
                else if (correctRate < 70) difficulty = "Médio";
                
                return {
                    question: question.question,
                    correctRate,
                    mostCommon,
                    difficulty
                };
            });
            
            questionStats.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}. ${item.question}</td>
                    <td>${item.correctRate}%</td>
                    <td>${item.mostCommon}</td>
                    <td>${item.difficulty}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Carregar respostas dissertativas
        function loadEssays() {
            const essaysContainer = document.getElementById('essaysList');
            essaysContainer.innerHTML = '';
            
            if (quizResults.length === 0) {
                essaysContainer.innerHTML = '<p style="text-align: center;">Nenhuma resposta dissertativa disponível</p>';
                return;
            }
            
            quizResults.forEach(student => {
                const essayCard = document.createElement('div');
                essayCard.className = 'answer-card essay';
                essayCard.innerHTML = `
                    <div class="student-info">
                        <h3>${student.name} - ${student.class}</h3>
                        <p>Data: ${formatDate(student.date)} | Pontuação: ${student.score}%</p>
                    </div>
                    <div class="question-text">${questions[10].question}</div>
                    <div class="essay-answer">${student.essay || 'Nenhuma resposta fornecida'}</div>
                `;
                essaysContainer.appendChild(essayCard);
            });
        }

        // Inicializar gráficos
        function initializeCharts() {
            if (quizResults.length === 0) return;
            
            // Gráfico de distribuição de pontuações
            const scoreRanges = [0, 0, 0, 0, 0]; // 0-20, 21-40, 41-60, 61-80, 81-100
            
            quizResults.forEach(student => {
                if (student.score <= 20) scoreRanges[0]++;
                else if (student.score <= 40) scoreRanges[1]++;
                else if (student.score <= 60) scoreRanges[2]++;
                else if (student.score <= 80) scoreRanges[3]++;
                else scoreRanges[4]++;
            });
            
            const scoreCtx = document.getElementById('scoreDistributionChart').getContext('2d');
            new Chart(scoreCtx, {
                type: 'bar',
                data: {
                    labels: ['0-20%', '21-40%', '41-60%', '61-80%', '81-100%'],
                    datasets: [{
                        label: 'Número de Alunos',
                        data: scoreRanges,
                        backgroundColor: [
                            '#e74c3c',
                            '#e67e22',
                            '#f39c12',
                            '#3498db',
                            '#2ecc71'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Distribuição de Pontuações'
                        }
                    }
                }
            });
            
            // Gráfico de desempenho por turma
            const classes = [...new Set(quizResults.map(student => student.class))];
            const performanceData = [];
            
            classes.forEach(classItem => {
                const classResults = quizResults.filter(student => student.class === classItem);
                const classPerformance = questions.slice(0, -1).map((_, index) => {
                    const correctCount = classResults.filter(student => 
                        student.answers[index] && student.answers[index].correct
                    ).length;
                    return Math.round((correctCount / classResults.length) * 100);
                });
                performanceData.push({
                    label: classItem,
                    data: classPerformance
                });
            });
            
            const performanceCtx = document.getElementById('performanceChart').getContext('2d');
            const colors = ['#4361ee', '#f72585', '#4cc9f0', '#ffbe0b'];
            
            new Chart(performanceCtx, {
                type: 'line',
                data: {
                    labels: questions.slice(0, -1).map((_, i) => `P${i+1}`),
                    datasets: performanceData.map((item, index) => ({
                        label: item.label,
                        data: item.data,
                        borderColor: colors[index % colors.length],
                        backgroundColor: `${colors[index % colors.length]}20`,
                        tension: 0.3
                    }))
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Desempenho por Turma (Taxa de Acerto por Pergunta)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Taxa de Acerto (%)'
                            }
                        }
                    }
                }
            });
            
            // Gráfico de análise por pergunta
            const questionStats = questions.slice(0, -1).map((_, index) => {
                const correctCount = quizResults.filter(student => 
                    student.answers[index] && student.answers[index].correct
                ).length;
                return Math.round((correctCount / quizResults.length) * 100);
            });
            
            const questionCtx = document.getElementById('questionAnalysisChart').getContext('2d');
            new Chart(questionCtx, {
                type: 'bar',
                data: {
                    labels: questions.slice(0, -1).map((_, i) => (i+1).toString()),
                    datasets: [{
                        label: 'Taxa de Acerto (%)',
                        data: questionStats,
                        backgroundColor: questionStats.map(rate => 
                            rate >= 70 ? '#2ecc71' : rate >= 50 ? '#f39c12' : '#e74c3c'
                        ),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Taxa de Acerto por Pergunta'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Taxa de Acerto (%)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Número da Pergunta'
                            }
                        }
                    }
                }
            });
        }

        // Visualizar detalhes do aluno
        function viewStudentDetail(studentId) {
            const student = quizResults.find(s => s.id === studentId);
            if (!student) return;
            
            document.getElementById('detailStudentName').textContent = student.name;
            document.getElementById('detailStudentClass').textContent = 
                `${student.class} - Pontuação: ${student.score}%`;
            
            const answersContainer = document.getElementById('studentAnswers');
            answersContainer.innerHTML = '';
            
            // Adicionar respostas objetivas
            student.answers.forEach((answer, index) => {
                const answerCard = document.createElement('div');
                answerCard.className = `answer-card ${answer.correct ? 'correct' : 'incorrect'}`;
                
                const studentAnswerText = answer.studentAnswer !== -1 ? 
                    getAnswerText(answer.studentAnswer) : 'Não respondida';
                
                answerCard.innerHTML = `
                    <div class="question-text">${index + 1}. ${answer.question}</div>
                    <div class="student-answer">Sua resposta: ${studentAnswerText}</div>
                    <div class="correct-answer">Resposta correta: ${getAnswerText(answer.correctAnswer)}</div>
                `;
                
                answersContainer.appendChild(answerCard);
            });
            
            // Adicionar resposta dissertativa
            const essayCard = document.createElement('div');
            essayCard.className = 'answer-card essay';
            essayCard.innerHTML = `
                <div class="question-text">11. ${questions[10].question}</div>
                <div class="essay-answer">${student.essay || 'Nenhuma resposta fornecida'}</div>
            `;
            answersContainer.appendChild(essayCard);
            
            document.getElementById('studentDetailModal').style.display = 'block';
        }

        // Fechar detalhes do aluno
        function closeStudentDetail() {
            document.getElementById('studentDetailModal').style.display = 'none';
        }

        // Aplicar filtros na tabela de alunos
        function applyFilters() {
            const classFilter = document.getElementById('classFilter').value;
            const scoreFilter = document.getElementById('scoreFilter').value;
            const searchText = document.getElementById('searchStudent').value.toLowerCase();
            
            const tbody = document.querySelector('#studentsTable tbody');
            tbody.innerHTML = '';
            
            let filteredResults = quizResults;
            
            // Aplicar filtros
            if (classFilter !== 'all') {
                filteredResults = filteredResults.filter(student => student.class === classFilter);
            }
            
            if (scoreFilter !== 'all') {
                if (scoreFilter === 'high') {
                    filteredResults = filteredResults.filter(student => student.score >= 80);
                } else if (scoreFilter === 'medium') {
                    filteredResults = filteredResults.filter(student => student.score >= 60 && student.score < 80);
                } else if (scoreFilter === 'low') {
                    filteredResults = filteredResults.filter(student => student.score < 60);
                }
            }
            
            if (searchText) {
                filteredResults = filteredResults.filter(student => 
                    student.name.toLowerCase().includes(searchText)
                );
            }
            
            // Atualizar tabela
            if (filteredResults.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">Nenhum resultado encontrado</td>`;
                tbody.appendChild(row);
                return;
            }
            
            filteredResults.forEach(student => {
                const scoreClass = student.score >= 80 ? 'score-high' : 
                                 student.score >= 60 ? 'score-medium' : 'score-low';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.class}</td>
                    <td>${formatDate(student.date)}</td>
                    <td><span class="score-badge ${scoreClass}">${student.score}%</span></td>
                    <td>${student.time}</td>
                    <td><button class="btn btn-secondary" onclick="viewStudentDetail(${student.id})">Ver Detalhes</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Aplicar filtros nas respostas dissertativas
        function applyEssayFilters() {
            const classFilter = document.getElementById('essayClassFilter').value;
            const searchText = document.getElementById('searchEssay').value.toLowerCase();
            
            const essaysContainer = document.getElementById('essaysList');
            essaysContainer.innerHTML = '';
            
            let filteredResults = quizResults;
            
            // Aplicar filtros
            if (classFilter !== 'all') {
                filteredResults = filteredResults.filter(student => student.class === classFilter);
            }
            
            if (searchText) {
                filteredResults = filteredResults.filter(student => 
                    student.name.toLowerCase().includes(searchText)
                );
            }
            
            // Atualizar lista de respostas dissertativas
            if (filteredResults.length === 0) {
                essaysContainer.innerHTML = '<p style="text-align: center;">Nenhuma resposta encontrada</p>';
                return;
            }
            
            filteredResults.forEach(student => {
                const essayCard = document.createElement('div');
                essayCard.className = 'answer-card essay';
                essayCard.innerHTML = `
                    <div class="student-info">
                        <h3>${student.name} - ${student.class}</h3>
                        <p>Data: ${formatDate(student.date)} | Pontuação: ${student.score}%</p>
                    </div>
                    <div class="question-text">${questions[10].question}</div>
                    <div class="essay-answer">${student.essay || 'Nenhuma resposta fornecida'}</div>
                `;
                essaysContainer.appendChild(essayCard);
            });
        }

        // Exportar para CSV
        function exportToCSV() {
            if (quizResults.length === 0) {
                alert('Não há dados para exportar.');
                return;
            }
            
            let csv = 'Nome,Turma,Data,Pontuação,Tempo,Resposta Dissertativa\n';
            
            quizResults.forEach(student => {
                const escapedEssay = `"${(student.essay || '').replace(/"/g, '""')}"`;
                csv += `"${student.name}","${student.class}","${student.date}","${student.score}%","${student.time}",${escapedEssay}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'resultados_quiz_financeiro.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Imprimir relatório
        function printReport() {
            window.print();
        }

        // ========== FUNÇÕES AUXILIARES ==========
        
        function formatDate(dateString) {
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            return new Date(dateString).toLocaleDateString('pt-BR', options);
        }

        function getAnswerText(answerIndex) {
            const letters = ['A', 'B', 'C', 'D'];
            return letters[answerIndex] || 'Não respondida';
        }
    </script>
</body>
</html>
